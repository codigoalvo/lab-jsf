<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:f="http://xmlns.jcp.org/jsf/core" xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns:p="http://primefaces.org/ui">

<ui:composition template="/templates/template.xhtml">
	<ui:define name="tituloJanela">#{msg['usuario.listar.titulo']}</ui:define>
	<ui:define name="conteudo">
		<f:metadata>
			<f:viewAction action="#{controleUsuario.consultar}" />
		</f:metadata>
		<p:growl id="messages" />
		<h:form id="frm-lista">
			<p:dataTable id="tblUsuarios" value="#{controleUsuario.usuarios}" var="usuario" paginator="true"
				paginatorPosition="bottom" rows="5" rowKey="#{usuario.id}" resizableColumns="true" tableStyle="table-layout: auto;"
				style="width:95%;" selection="#{controleUsuario.usuario}" selectionMode="single">
				<f:facet name="header">
					<div align="center">
						<h:outputLabel value="#{msg['usuario.listar.titulo']}" style="padding:5px;" />
					</div>
				</f:facet>
				<p:column headerText="#{msg['usuario.id']}" width="3%">
					<h:outputText value="#{usuario.id}" />
				</p:column>
				<p:column headerText="#{msg['usuario.login']}" width="15%">
					<h:outputText value="#{usuario.login}" />
				</p:column>
				<p:column headerText="#{msg['usuario.nome']}" width="25%">
					<h:outputText value="#{usuario.nome}" />
				</p:column>
				<p:column headerText="#{msg['usuario.email']}" width="25%">
					<h:outputText value="#{usuario.email}" />
				</p:column>
				<p:column headerText="#{msg['usuario.tipo']}" width="10%">
					<h:outputText value="#{usuario.tipo.descricao}" />
				</p:column>
				<p:column headerText="#{msg['usuario.ativo']}" width="4%">
					<h:outputText value="#{usuario.ativo?msg['sim']:msg['nao']}" />
				</p:column>
				<p:column width="10%">
					<f:facet name="header">
						<div align="center">
							<p:commandButton action="#{controleUsuario.novo()}" value="#{msg['listar.novo']}" icon="ui-icon-document"
								process="@this" update=":frm-edicao:dlg-edicao" oncomplete="PF('dialogEditar').show()">
								<p:resetInput target=":frm-edicao:dlg-edicao" />
							</p:commandButton>
						</div>
					</f:facet>
					<div align="center">
						<p:commandButton action="#{controleUsuario.alterar(usuario)}" title="#{msg['listar.alterar']}"
							icon="ui-icon-pencil" style="margin-right:6px;padding:0px;width:2em" styleClass="botaoCinza" process="@this"
							update=":frm-edicao:dlg-edicao" oncomplete="PF('dialogEditar').show()">
							<p:resetInput target=":frm-edicao:dlg-edicao" />
						</p:commandButton>
						<p:commandButton action="#{controleUsuario.excluir(usuario)}" title="#{msg['listar.excluir']}"
							icon="ui-icon-trash" style="padding:0px;width:2em" styleClass="botaoCinza"
							onclick="if (!confirm('#{msg['mensagem.confirmarExclusao']}')) return false" process="@this"
							update=":frm-edicao:dlg-edicao" oncomplete="PF('dialogEditar').show()">
							<p:resetInput target=":frm-edicao:dlg-edicao" />
						</p:commandButton>
					</div>
				</p:column>
			</p:dataTable>
			<p:contextMenu for="tblUsuarios">
				<p:menuitem value="#{msg['listar.alterar']}" icon="ui-icon-pencil" update=":frm-edicao:dlg-edicao"
					action="#{controleUsuario.alterar(controleUsuario.usuario)}" oncomplete="PF('dialogEditar').show()">
					<p:resetInput target=":frm-edicao:dlg-edicao" />
				</p:menuitem>
				<p:menuitem value="#{msg['listar.excluir']}" icon="ui-icon-trash" update=":frm-lista:tblUsuarios"
					onclick="if (!confirm('#{msg['mensagem.confirmarExclusao']}')) return false" 
					action="#{controleUsuario.excluir(controleUsuario.usuario)}" />
			</p:contextMenu>
		</h:form>

		<h:form id="frm-edicao" prependId="false">
			<p:dialog id="dlg-edicao" widgetVar="dialogEditar" header="#{msg['usuario.editar.titulo']}" modal="true" resizable="false">
				<p:panelGrid id="gridEdicao" columns="2">
					<f:facet name="footer">
						<div align="center">
							<p:commandButton action="#{controleUsuario.cancelar()}" value="#{msg['editar.cancelar']}" immediate="true"
								ajax="false" icon="ui-icon-closethick" styleClass="botaoVermelho margem_10" oncomplete="dialogEditar.hide();" />
							<p:commandButton action="#{controleUsuario.gravar()}" value="#{msg['editar.gravar']}" ajax="false"
								icon="ui-icon-check" styleClass="botaoVerde margem_10" update="gridEdicao" process="dlg-edicao" />
						</div>
					</f:facet>
					<h:outputLabel value="#{msg['usuario.id']}" for="ID" />
					<p:inputText value="#{controleUsuario.usuario.id}" readonly="true" id="ID" />
					<h:outputLabel value="#{msg['usuario.login']}" for="LOGIN" />
					<p:inputText value="#{controleUsuario.usuario.login}" id="LOGIN" maxlength="50" size="50" />
					<h:outputLabel value="#{msg['usuario.senha']}" for="SENHA" />
					<p:password value="#{controleUsuario.usuario.senha}" id="SENHA" maxlength="30" size="50" redisplay="true" />
					<h:outputLabel value="#{msg['usuario.nome']}" for="NOME" />
					<p:inputText value="#{controleUsuario.usuario.nome}" id="NOME" maxlength="150" size="50" />
					<h:outputLabel value="#{msg['usuario.email']}" for="EMAIL" />
					<p:inputText value="#{controleUsuario.usuario.email}" id="EMAIL" maxlength="250" size="50" />
					<h:outputLabel value="#{msg['usuario.tipo']}" for="TIPO" />
					<p:selectOneMenu value="#{controleUsuario.usuario.tipo}" id="TIPO" style="width:200px">
						<f:selectItems value="#{controleUsuario.tiposUsuario}" />
					</p:selectOneMenu>
					<h:outputLabel value="#{msg['usuario.ativo']}" for="ATIVO" />
					<p:selectBooleanCheckbox value="#{controleUsuario.usuario.ativo}" id="ATIVO" />
					<p:focus for="LOGIN"/>
				</p:panelGrid>
				<p:messages id="msgs-dialog" />
			</p:dialog>
		</h:form>

	</ui:define>
</ui:composition>
</html>
